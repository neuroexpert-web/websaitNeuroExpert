import re

class IntentChecker:
    """Простая проверка релевантности вопроса"""
    
    RELEVANT_KEYWORDS = [
        # Услуги
        'аудит', 'анализ', 'проверка', 'диагностика',
        'сайт', 'приложение', 'разработка', 'создание',
        'ai', 'ии', 'искусственный интеллект', 'бот', 'ассистент', 'чатбот',
        'поддержка', 'сопровождение', 'обслуживание',
        'автоматизация', 'цифровизация', 'digital',
        # Бизнес
        'бизнес', 'компания', 'продажи', 'клиенты', 'прибыль',
        'рост', 'конверсия', 'roi', 'окупаемость',
        # Действия
        'цена', 'стоимость', 'сколько', 'заказать', 'купить',
        'консультация', 'договор', 'работа', 'сроки'
    ]
    
    IRRELEVANT_KEYWORDS = [
        'погода', 'новости', 'спорт', 'политика', 'футбол',
        'рецепт', 'готовить', 'кино', 'фильм', 'музыка',
        'здоровье', 'лечение', 'болезнь', 'врач'
    ]
    
    def is_relevant(self, message: str) -> bool:
        """
        Проверка релевантности вопроса
        Возвращает True, если вопрос связан с услугами
        """
        message_lower = message.lower()
        
        # Проверка на явно нерелевантные темы
        if any(keyword in message_lower for keyword in self.IRRELEVANT_KEYWORDS):
            return False
        
        # Проверка на релевантные темы
        if any(keyword in message_lower for keyword in self.RELEVANT_KEYWORDS):
            return True
        
        # Короткие вопросы ("привет", "да", "спасибо") — считаем релевантными
        if len(message.split()) <= 3:
            return True
        
        # По умолчанию считаем релевантным (чтобы не терять клиентов)
        return True

# Глобальный экземпляр
intent_checker = IntentChecker()
